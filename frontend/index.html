<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FTP Media Sync for Castus Servers</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Module-specific CSS -->
    <link rel="stylesheet" href="dashboard/dashboard.css">
    <link rel="stylesheet" href="servers/servers.css">
    <link rel="stylesheet" href="settings/settings.css">
    <link rel="stylesheet" href="ai_settings/ai_settings.css">
    <link rel="stylesheet" href="admin/admin.css">
    <link rel="stylesheet" href="scheduling/scheduling.css">
    <link rel="stylesheet" href="meeting_schedule/meeting_schedule.css">
    <link rel="stylesheet" href="fill_graphics/fill_graphics.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-content">
            <div class="navbar-brand">
                <i class="fas fa-sync-alt"></i>
                <span>FTP Media Sync for Castus Servers</span>
            </div>
            <div class="navbar-nav">
                <button class="nav-item active" onclick="showPanel('dashboard')">
                    <i class="fas fa-home"></i>
                    Dashboard
                </button>
                <button class="nav-item" onclick="showPanel('servers')">
                    <i class="fas fa-server"></i>
                    Servers
                </button>
                <button class="nav-item" onclick="showPanel('settings')">
                    <i class="fas fa-cog"></i>
                    Settings
                </button>
                <button class="nav-item" onclick="showPanel('ai-settings')">
                    <i class="fas fa-brain"></i>
                    AI Settings
                </button>
                <button class="nav-item" onclick="showPanel('admin')">
                    <i class="fas fa-tools"></i>
                    Admin
                </button>
                <button class="nav-item" onclick="showPanel('scheduling')">
                    <i class="fas fa-calendar-alt"></i>
                    Scheduling
                </button>
                <button class="nav-item" onclick="showPanel('meetings')">
                    <i class="fas fa-calendar-check"></i>
                    Meetings Schedule
                </button>
                <button class="nav-item" onclick="showPanel('fill-graphics')">
                    <i class="fas fa-image"></i>
                    Fill Graphics
                </button>
                <button class="nav-item dark-mode-toggle" onclick="toggleDarkMode()" id="darkModeToggle">
                    <i class="fas fa-moon"></i>
                    Dark
                </button>
            </div>
        </div>
    </nav>

    <div class="container">

        <!-- Dashboard Panel -->
        <div id="dashboard" class="panel dashboard-panel active">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-home"></i> Dashboard</h2>
                <p>Monitor and control your FTP synchronization</p>
            </div>

            <div class="dashboard-stats-grid">
                <div class="dashboard-stat-card">
                    <div class="dashboard-stat-icon">
                        <i class="fas fa-server"></i>
                    </div>
                    <div class="dashboard-stat-content">
                        <h3>Source Server</h3>
                        <p id="sourceStatusText">Not Connected</p>
                    </div>
                </div>
                <div class="dashboard-stat-card">
                    <div class="dashboard-stat-icon">
                        <i class="fas fa-server"></i>
                    </div>
                    <div class="dashboard-stat-content">
                        <h3>Target Server</h3>
                        <p id="targetStatusText">Not Connected</p>
                    </div>
                </div>
                <div class="dashboard-stat-card">
                    <div class="dashboard-stat-icon">
                        <i class="fas fa-file"></i>
                    </div>
                    <div class="dashboard-stat-content">
                        <h3>Files Scanned</h3>
                        <p id="fileCountText">0 files</p>
                    </div>
                </div>
                <div class="dashboard-stat-card">
                    <div class="dashboard-stat-icon">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <div class="dashboard-stat-content">
                        <h3>Sync Queue</h3>
                        <p id="syncStatusText">0 files queued</p>
                    </div>
                </div>
            </div>


            <div class="dashboard-card">
                <h3><i class="fas fa-search"></i> File Scanning and Analysis</h3>
                <div class="dashboard-action-buttons">
                    <!-- First row: Basic file operations -->
                    <div class="dashboard-action-buttons-row">
                        <button class="button primary small" onclick="scanSelectedFolders()">
                            <i class="fas fa-search"></i> Scan Files
                        </button>
                        <button class="button secondary small" onclick="compareFiles()" disabled>
                            <i class="fas fa-balance-scale"></i> Compare Files
                        </button>
                        <button class="button secondary small" onclick="analyzeFiles()" disabled id="analyzeFilesBtn">
                            <i class="fas fa-brain"></i> Analyze Files
                        </button>
                        <button class="button success small" onclick="addAllToSyncQueue()">
                            <i class="fas fa-plus"></i> Add All to Sync
                        </button>
                    </div>
                    
                    <!-- Second row: Folder operations -->
                    <div class="action-buttons-row" style="margin-top: 15px;">
                        <button class="button secondary small" id="addFolderButton" onclick="addAllFromFolderToSyncQueue()" disabled>
                            <i class="fas fa-folder-plus"></i> Add Folder
                        </button>
                        <button class="button info small" id="analyzeFolderButton" onclick="analyzeAllFromFolder()" disabled>
                            <i class="fas fa-brain"></i> Analyze Folder
                        </button>
                        <button class="button info small" id="analyzeAllUnanalyzedButton" onclick="addAllUnanalyzedToAnalysisQueue()" disabled>
                            <i class="fas fa-brain"></i> Analyze All Unanalyzed
                        </button>
                    </div>
                    
                    <!-- Third row: Analysis controls -->
                    <div class="action-buttons-row" style="margin-top: 15px;">
                        <button class="button primary small" id="startAnalysisButton" onclick="startAnalysis()" disabled>
                            <i class="fas fa-play"></i> Start Analysis
                        </button>
                        <button class="button danger small" onclick="stopAnalysis()" id="stopAnalysisButton" disabled>
                            <i class="fas fa-stop"></i> Stop Analysis
                        </button>
                        <button class="button warning small" onclick="clearAnalysisQueue()" id="clearAnalysisButton" disabled>
                            <i class="fas fa-trash"></i> Clear Analysis Queue
                        </button>
                    </div>
                    
                    <!-- Fourth row: Auto toggles and settings -->
                    <div class="action-buttons-row" style="margin-top: 15px;">
                        <button class="button success small" onclick="toggleAutoRestart()" id="autoRestartToggle">
                            <i class="fas fa-toggle-on"></i> Auto-Restart: ON
                        </button>
                        <button class="button success small" onclick="togglePeriodicRescanning()" id="rescanToggle">
                            <i class="fas fa-toggle-on"></i> Auto-Rescan: ON
                        </button>
                        <div class="rescan-config" style="display: flex; align-items: center; gap: 8px;">
                            <label for="rescanIntervalInput" style="font-size: 0.875rem;">Rescan Interval:</label>
                            <input type="number" id="rescanIntervalInput" min="30" max="600" value="120" style="width: 80px;">
                            <span style="font-size: 0.875rem;">seconds</span>
                            <button class="button secondary" onclick="updateRescanInterval()">
                                <i class="fas fa-check"></i> Update
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="analysisMonitorStatus" class="analysis-monitor" style="display: none;">
                    <div class="monitor-header">
                        <h4><i class="fas fa-chart-line"></i> Analysis Monitor</h4>
                    </div>
                    <div class="monitor-stats">
                        <span id="analysisRuntime">Runtime: 0s</span>
                        <span id="analysisProgress">Progress: 0s ago</span>
                        <span id="currentFile">File: None</span>
                        <span id="queueRemaining">Queue: 0</span>
                        <span id="rescanStatus" style="display: none;">Next Rescan: --</span>
                    </div>
                </div>
                
                <div class="analysis-actions" style="margin-top: 1rem;">
                    <button class="button warning small" onclick="skipCurrentFile()" id="skipFileButton" disabled>
                        <i class="fas fa-forward"></i> Skip Current File
                    </button>
                    <button class="button secondary small" onclick="restartAnalysis()" id="restartButton" disabled>
                        <i class="fas fa-redo"></i> Restart Analysis
                    </button>
                    <button class="button warning small" onclick="clearSyncQueue()">
                        <i class="fas fa-trash"></i> Clear Queue
                    </button>
                    <button class="button danger small" onclick="addAllUnmatchedToDeleteQueue()" id="deleteAllUnmatchedButton" disabled>
                        <i class="fas fa-trash-alt"></i> Delete All Unmatched
                    </button>
                    <button class="button danger small" onclick="addFolderUnmatchedToDeleteQueue()" id="deleteFolderButton" disabled>
                        <i class="fas fa-folder-minus"></i> Delete Folder
                    </button>
                </div>
                
                <div class="sync-actions" style="margin-top: 15px;">
                    <button class="button primary small" onclick="startSync()" id="syncButton" disabled>
                        <i class="fas fa-sync-alt"></i> Start Sync
                    </button>
                    <button class="button danger small" onclick="stopSync()" id="stopButton" disabled>
                        <i class="fas fa-stop"></i> Stop Sync
                    </button>
                    <button class="button danger small" onclick="deleteFiles()" id="deleteButton" disabled>
                        <i class="fas fa-trash"></i> Delete Files
                    </button>
                    <button class="button warning small" onclick="clearDeleteQueue()" id="clearDeleteButton" disabled>
                        <i class="fas fa-trash-restore"></i> Clear Delete Queue
                    </button>
                    <button class="button secondary small" onclick="clearScannedFiles()">
                        <i class="fas fa-broom"></i> Clear Results
                    </button>
                </div>
                
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-text" id="progressText">Preparing sync...</div>
                    <div class="progress-bar" id="progressBar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-stats" id="progressStats">0 / 0 files</div>
                </div>
            </div>
        </div>

        <!-- Servers Panel -->
        <div id="servers" class="panel servers-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-server"></i> Server Configuration</h2>
                <p>Configure your source and target FTP servers</p>
            </div>
            
            <div class="servers-grid">
                <div class="servers-card servers-source-card">
                    <div class="servers-header">
                        <h3><i class="fas fa-upload"></i> Source Server</h3>
                        <button class="button small" onclick="testConnection('source')" id="sourceTestBtn">
                            <i class="fas fa-plug"></i> Test Connection
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="sourceHost">Host</label>
                        <input type="text" id="sourceHost" class="form-control" placeholder="192.168.1.100" value="192.168.1.100">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="sourcePort">Port</label>
                            <input type="number" id="sourcePort" class="form-control" placeholder="21" value="21">
                        </div>
                        <div class="form-group">
                            <label for="sourceUser">Username</label>
                            <input type="text" id="sourceUser" class="form-control" placeholder="username">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sourcePass">Password</label>
                        <input type="password" id="sourcePass" class="form-control" placeholder="password">
                    </div>
                    <div class="form-group" style="display: none;">
                        <label for="sourcePathSelect">Path</label>
                        <select id="sourcePathSelect" onchange="updateSourcePath()">
                            <option value="/mnt/main/ATL26 On-Air Content">On-Air Content</option>
                            <option value="/mnt/main/Recordings">Recordings</option>
                        </select>
                        <input type="text" id="sourcePath" placeholder="/media/videos" value="/mnt/main/ATL26 On-Air Content" style="margin-top: 5px;">
                    </div>
                </div>

                <div class="servers-card servers-target-card">
                    <div class="servers-header">
                        <h3><i class="fas fa-download"></i> Target Server</h3>
                        <button class="button small" onclick="testConnection('target')" id="targetTestBtn">
                            <i class="fas fa-plug"></i> Test Connection
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="targetHost">Host</label>
                        <input type="text" id="targetHost" class="form-control" placeholder="192.168.1.101" value="192.168.1.101">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="targetPort">Port</label>
                            <input type="number" id="targetPort" class="form-control" placeholder="21" value="21">
                        </div>
                        <div class="form-group">
                            <label for="targetUser">Username</label>
                            <input type="text" id="targetUser" class="form-control" placeholder="username">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="targetPass">Password</label>
                        <input type="password" id="targetPass" class="form-control" placeholder="password">
                    </div>
                    <div class="form-group" style="display: none;">
                        <label for="targetPathSelect">Path</label>
                        <select id="targetPathSelect" onchange="updateTargetPath()">
                            <option value="/mnt/main/ATL26 On-Air Content">On-Air Content</option>
                            <option value="/mnt/main/Recordings">Recordings</option>
                        </select>
                        <input type="text" id="targetPath" placeholder="/media/videos" value="/mnt/main/ATL26 On-Air Content" style="margin-top: 5px;">
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <div id="settings" class="panel settings-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-cog"></i> Sync Settings</h2>
                <p>Configure file filtering and synchronization options</p>
            </div>
            
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-filter"></i> File Filters</h3>
                    <div class="form-group">
                        <label for="fileFilter">File Extensions</label>
                        <input type="text" id="fileFilter" class="form-control" placeholder="mp4,mkv,avi,mov,wmv" value="mp4,mkv,avi,mov,wmv">
                        <small>Comma-separated list of file extensions</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="minFileSize">Min Size (MB)</label>
                            <input type="number" id="minFileSize" class="form-control" placeholder="1" value="1">
                        </div>
                        <div class="form-group">
                            <label for="maxFileSize">Max Size (GB)</label>
                            <input type="number" id="maxFileSize" class="form-control" placeholder="50" value="50">
                        </div>
                    </div>
                </div>
                
                <div class="settings-card">
                    <h3><i class="fas fa-sliders-h"></i> Sync Options</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="includeSubdirs" checked>
                        <label for="includeSubdirs">Include subdirectories</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="overwriteExisting">
                        <label for="overwriteExisting">Overwrite existing files with size differences</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="dryRun">
                        <label for="dryRun">Dry run (preview changes without actual sync)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="dryRunDelete" checked>
                        <label for="dryRunDelete">Dry run for deletions (preview delete operations)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="keepTempFiles">
                        <label for="keepTempFiles">Keep temp files for debugging</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Settings Panel -->
        <div id="ai-settings" class="panel ai-settings-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-brain"></i> AI Analysis Settings</h2>
                <p>Configure AI provider and analysis options</p>
            </div>
            
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-toggle-on"></i> AI Analysis</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="aiEnabled">
                        <label for="aiEnabled">Enable AI analysis</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="transcriptionOnly">
                        <label for="transcriptionOnly">Transcription only (no AI analysis)</label>
                    </div>
                </div>
                
                <div class="settings-card">
                    <h3><i class="fas fa-robot"></i> AI Provider</h3>
                    <div class="form-group">
                        <label for="aiProvider">AI Provider</label>
                        <select id="aiProvider" class="form-control">
                            <option value="openai">OpenAI (GPT)</option>
                            <option value="anthropic">Anthropic (Claude)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="aiModel">AI Model</label>
                        <select id="aiModel" class="form-control">
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                            <option value="gpt-4">GPT-4</option>
                            <option value="claude-3-sonnet-20240229">Claude 3 Sonnet</option>
                            <option value="claude-3-opus-20240229">Claude 3 Opus</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-card">
                    <h3><i class="fas fa-key"></i> API Keys</h3>
                    <div class="form-group">
                        <label for="openaiApiKey">OpenAI API Key</label>
                        <input type="password" id="openaiApiKey" class="form-control" placeholder="sk-...">
                    </div>
                    <div class="form-group">
                        <label for="anthropicApiKey">Anthropic API Key</label>
                        <input type="password" id="anthropicApiKey" class="form-control" placeholder="sk-ant-...">
                    </div>
                    <div class="form-group">
                        <label for="maxChunkSize">Max Chunk Size</label>
                        <input type="number" id="maxChunkSize" class="form-control" placeholder="4000" value="4000">
                        <small>Maximum characters per AI analysis chunk</small>
                    </div>
                </div>
            </div>
            
            <div class="ai-settings-actions">
                <button class="button primary" onclick="saveAISettings()">
                    <i class="fas fa-save"></i> Save AI Settings
                </button>
                <button class="button secondary" onclick="loadAISettings()">
                    <i class="fas fa-download"></i> Load AI Settings
                </button>
                <button class="button warning" onclick="testAIConnection()">
                    <i class="fas fa-vial"></i> Test AI Connection
                </button>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="admin" class="panel admin-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-tools"></i> Administration</h2>
                <p>Configuration management and system tools</p>
            </div>
            
            <div class="admin-grid">
                <div class="admin-card">
                    <h3><i class="fas fa-save"></i> Configuration</h3>
                    <div class="admin-buttons">
                        <button class="button primary" onclick="loadConfig()">
                            <i class="fas fa-upload"></i> Load Config
                        </button>
                        <button class="button success" onclick="saveConfig()">
                            <i class="fas fa-save"></i> Save Config
                        </button>
                        <button class="button secondary" onclick="createSampleConfig()">
                            <i class="fas fa-file-code"></i> Create Sample
                        </button>
                        <button class="button warning" onclick="resetForm()">
                            <i class="fas fa-undo"></i> Reset Form
                        </button>
                    </div>
                </div>
                
                <div class="admin-card">
                    <h3><i class="fas fa-chart-line"></i> System Status</h3>
                    <div class="status-info">
                        <p><strong>Backend:</strong> <span id="backendStatus">Checking...</span></p>
                        <p><strong>Version:</strong> <span id="versionInfo">1.0.0</span></p>
                        <p><strong>Uptime:</strong> <span id="uptimeInfo">--</span></p>
                    </div>
                </div>
                
                <div class="admin-card">
                    <h3><i class="fas fa-database"></i> Database Management</h3>
                    <div class="admin-buttons">
                        <button class="button danger" onclick="clearAllAnalyses()">
                            <i class="fas fa-trash-alt"></i> Clear All Analysis Data
                        </button>
                    </div>
                    <p><small><strong>Warning:</strong> This will permanently delete all analysis results from the database. This action cannot be undone.</small></p>
                </div>
            </div>
        </div>

        <!-- Scheduling Panel ---->
        <div id="scheduling" class="panel scheduling-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-calendar-alt"></i> ATL26 Comcast Channel 26 Scheduling</h2>
                <p>Schedule analyzed content for broadcast on ATL26 Comcast Channel 26</p>
            </div>
            
            <div class="scheduling-grid">
                <!-- Available Content Section -->
                <div class="scheduling-card collapsed">
                    <h3><i class="fas fa-video"></i> Available Content <span id="contentCount" style="font-weight: normal; font-size: 0.9em; color: #6c757d; margin-left: 0.5rem;"></span></h3>
                    <div class="card-content">
                        <div class="content-filters">
                        <div class="filter-row">
                            <select id="contentTypeFilter">
                                <option value="">All Content Types</option>
                                <option value="AN">Atlanta Now</option>
                                <option value="BMP">Bumps</option>
                                <option value="IMOW">IMOW</option>
                                <option value="IM">Inclusion Months</option>
                                <option value="IA">Inside Atlanta</option>
                                <option value="LM">Legislative Minute</option>
                                <option value="MTG">Meetings</option>
                                <option value="MAF">Moving Atlanta Forward</option>
                                <option value="PKG">Packages</option>
                                <option value="PMO">Promos</option>
                                <option value="PSA">PSAs</option>
                                <option value="SZL">Sizzles</option>
                                <option value="SPP">Special Projects</option>
                                <option value="OTHER">Other</option>
                            </select>
                            <select id="durationCategoryFilter">
                                <option value="">All Durations</option>
                                <option value="id">ID (< 16s)</option>
                                <option value="spots">Spots (16s - 2min)</option>
                                <option value="short_form">Short Form (2-20min)</option>
                                <option value="long_form">Long Form (> 20min)</option>
                            </select>
                        </div>
                        <div class="filter-row">
                            <input type="text" id="contentSearchFilter" placeholder="Search content titles...">
                            <button class="button primary" onclick="loadAvailableContent()">
                                <i class="fas fa-search"></i> Load Content
                            </button>
                        </div>
                    </div>
                    <div id="availableContentList" class="content-list">
                        <p>Click "Load Content" to display available analyzed content</p>
                    </div>
                    </div>
                </div>
                
                <!-- Configuration Section -->
                <div class="scheduling-card collapsed">
                    <h3><i class="fas fa-cog"></i> Schedule Configuration</h3>
                    <div class="card-content">
                        <div class="config-buttons">
                        <button class="button secondary" onclick="showScheduleConfig('durations')">
                            <i class="fas fa-clock"></i> Duration Categories
                        </button>
                        <button class="button secondary" onclick="showScheduleConfig('timeslots')">
                            <i class="fas fa-calendar-day"></i> Timeslots
                        </button>
                        <button class="button secondary" onclick="showScheduleConfig('replay')">
                            <i class="fas fa-redo"></i> Replay Delays
                        </button>
                        <button class="button secondary" onclick="showScheduleConfig('expiration')">
                            <i class="fas fa-hourglass-end"></i> Content Expiration
                        </button>
                        <button class="button secondary" onclick="showScheduleConfig('rotation')">
                            <i class="fas fa-sync-alt"></i> Category Rotation
                        </button>
                        </div>
                    </div>
                </div>
                
                <!-- Schedule Creation Section -->
                <div class="scheduling-card collapsed">
                    <h3><i class="fas fa-plus-circle"></i> Create Schedules</h3>
                    <div class="card-content">
                        <div class="schedule-creation">
                        <div class="form-group">
                            <label for="scheduleDate">Schedule Date</label>
                            <input type="date" id="scheduleDate" class="form-control" value="">
                        </div>
                        <div class="schedule-buttons">
                            <button class="button success" onclick="createDailySchedule()">
                                <i class="fas fa-calendar-plus"></i> Create Daily Schedule
                            </button>
                            <button class="button success" onclick="createWeeklySchedule()">
                                <i class="fas fa-calendar-week"></i> Create Weekly Schedule
                            </button>
                            <button class="button success" onclick="createMonthlySchedule()">
                                <i class="fas fa-calendar-alt"></i> Create Monthly Schedule
                            </button>
                        </div>
                        </div>
                    </div>
                </div>
                
                <!-- Schedule Management Section -->
                <div class="scheduling-card">
                    <h3><i class="fas fa-list-alt"></i> Schedule Management</h3>
                    <div class="card-content">
                        <div class="schedule-management">
                        <div class="form-group">
                            <label for="viewScheduleDate">View Schedule Date</label>
                            <input type="date" id="viewScheduleDate" class="form-control" value="">
                        </div>
                        <div class="schedule-buttons">
                            <button class="button secondary" onclick="listAllSchedules()">
                                <i class="fas fa-list"></i> List All Schedules
                            </button>
                            <button class="button success" onclick="showLoadScheduleFromFTPModal()">
                                <i class="fas fa-file-import"></i> Load from FTP
                            </button>
                            <button class="button warning" onclick="deleteSchedule()">
                                <i class="fas fa-trash"></i> Delete Schedule
                            </button>
                            <button class="button secondary" onclick="exportSchedule()">
                                <i class="fas fa-download"></i> Export Schedule
                            </button>
                            <button class="button danger" onclick="deleteAllSchedules()">
                                <i class="fas fa-trash-alt"></i> Delete All Schedules
                            </button>
                        </div>
                    </div>
                    <div id="scheduleDisplay" class="schedule-display">
                        <p>Select a date and click "View Schedule" to display the daily schedule, or click "List All Schedules" to see all available schedules</p>
                    </div>
                    </div>
                </div>
                
                <!-- Schedule Templates Section -->
                <div class="scheduling-card" id="scheduleTemplatesCard">
                    <h3><i class="fas fa-file-alt"></i> Schedule Templates</h3>
                    <div class="card-content">
                        <div class="template-buttons">
                            <!-- First row of buttons -->
                            <div class="template-buttons-row">
                                <button class="button primary small" onclick="console.log('Daily button clicked'); showLoadTemplateModal()">
                                    <i class="fas fa-file-import"></i> Import Daily Template
                                </button>
                                <button class="button primary small" onclick="console.log('Weekly button clicked'); showLoadWeeklyTemplateModal()">
                                    <i class="fas fa-calendar-week"></i> Import Weekly Template
                                </button>
                                <button class="button primary small" onclick="console.log('Monthly button clicked'); showLoadMonthlyTemplateModal()">
                                    <i class="fas fa-calendar-alt"></i> Import Monthly Template
                                </button>
                                <button class="button info small" onclick="showTemplateLibrary()">
                                    <i class="fas fa-folder-open"></i> Template Library
                                </button>
                            </div>
                            
                            <!-- Second row of buttons -->
                            <div class="template-buttons-row" style="margin-top: 15px;">
                                <button class="button warning small" onclick="importDailyMeetings()">
                                    <i class="fas fa-calendar-day"></i> Import Daily Meetings
                                </button>
                                <button class="button warning small" onclick="importWeeklyMeetings()">
                                    <i class="fas fa-calendar-week"></i> Import Weekly Meetings
                                </button>
                                <button class="button warning small" onclick="importMonthlyMeetings()">
                                    <i class="fas fa-calendar"></i> Import Monthly Meetings
                                </button>
                                <button class="button secondary small" onclick="console.log('Fill gaps button clicked'); fillScheduleGaps()">
                                    <i class="fas fa-fill"></i> Fill Schedule Gaps
                                </button>
                                <button class="button success small" onclick="exportCurrentTemplate()" id="exportTemplateBtn" style="display: none;">
                                    <i class="fas fa-file-export"></i> Export Template
                                </button>
                            </div>
                        </div>
                        <div id="schedulingTemplateInfo" class="scheduling-template-info" style="display: none;">
                            <p><strong>Template:</strong> <span id="schedulingTemplateName">Untitled</span></p>
                            <p><strong>Items:</strong> <span id="schedulingTemplateItemCount">0</span> | <strong>Duration:</strong> <span id="schedulingTemplateDuration">00:00:00</span></p>
                        </div>
                        <div id="schedulingTemplateDisplay" class="scheduling-template-display">
                            <p style="text-align: center; color: #666;">Load a template file to begin editing</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Configuration Modals -->
            <div id="configModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="configModalTitle">Configuration</h3>
                        <button class="modal-close" onclick="closeConfigModal()">&times;</button>
                    </div>
                    <div id="configModalBody" class="modal-body">
                        <!-- Dynamic content will be loaded here -->
                    </div>
                    <div class="modal-footer">
                        <button class="button secondary" onclick="closeConfigModal()">Cancel</button>
                        <button class="button primary" onclick="saveScheduleConfig()">Save</button>
                    </div>
                </div>
            </div>
            
            <!-- Export Schedule Modal -->
            <div id="exportModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-download"></i> Export Schedule</h3>
                        <button class="modal-close" onclick="closeExportModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Schedule Date</label>
                            <p id="exportScheduleDate" style="font-weight: bold; margin: 5px 0;"></p>
                        </div>
                        <div class="form-group">
                            <label for="modalExportServer">Export Server</label>
                            <select id="modalExportServer" class="form-control">
                                <option value="source">Source Server</option>
                                <option value="target" selected>Target Server</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="modalExportPath">Export Path</label>
                            <input type="text" id="modalExportPath" class="form-control" value="/mnt/md127/Schedules/Contributors/Jay" placeholder="/path/to/export">
                        </div>
                        <div class="form-group">
                            <label for="modalExportFilename">Filename</label>
                            <input type="text" id="modalExportFilename" class="form-control" placeholder="mon_20250127.sch">
                        </div>
                        <div class="form-group">
                            <label for="modalExportFormat">Export Format</label>
                            <select id="modalExportFormat" class="form-control">
                                <option value="castus">Castus Daily Schedule</option>
                                <option value="castus_weekly">Castus Weekly Schedule</option>
                                <option value="castus_monthly">Castus Monthly Schedule</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="button secondary" onclick="closeExportModal()">Cancel</button>
                        <button class="button primary" onclick="confirmExport()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Export Result Modal -->
            <div id="exportResultModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 500px;">
                    <div class="modal-header">
                        <h3 id="exportResultTitle"><i class="fas fa-info-circle"></i> Export Result</h3>
                        <button class="modal-close" onclick="closeExportResultModal()">&times;</button>
                    </div>
                    <div class="modal-body" style="text-align: center; padding: 30px;">
                        <div id="exportResultIcon" style="font-size: 48px; margin-bottom: 20px;"></div>
                        <h4 id="exportResultMessage" style="margin-bottom: 10px;"></h4>
                        <p id="exportResultDetails" style="color: #666;"></p>
                    </div>
                    <div class="modal-footer" style="justify-content: center;">
                        <button class="button primary" onclick="closeExportResultModal()">OK</button>
                    </div>
                </div>
            </div>
            
            
            <!-- Load Schedule from FTP Modal -->
            <div id="loadScheduleFromFTPModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-file-import"></i> Load Schedule from Castus</h3>
                        <button class="modal-close" onclick="closeLoadScheduleFromFTPModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="scheduleLoadServer">Select Server</label>
                            <select id="scheduleLoadServer" class="form-control" onchange="loadScheduleFilesFromFTP()">
                                <option value="">Select a server...</option>
                                <option value="source">Source Server (castus1)</option>
                                <option value="target">Target Server (castus2)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="scheduleLoadPath">Schedule Path</label>
                            <input type="text" id="scheduleLoadPath" class="form-control" value="/mnt/md127/Schedules" placeholder="/path/to/schedules">
                            <button class="button secondary small" onclick="loadScheduleFilesFromFTP()" style="margin-top: 5px;">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div class="form-group">
                            <label>Available Schedule Files</label>
                            <div id="scheduleLoadFileList" class="file-list" style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px;">
                                <p style="color: #666;">Select a server and click Refresh to load schedule files</p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="scheduleLoadDate">Schedule Date</label>
                            <input type="date" id="scheduleLoadDate" class="form-control">
                            <small>Date this schedule should be saved for in the database</small>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="button secondary" onclick="closeLoadScheduleFromFTPModal()">Cancel</button>
                        <button class="button primary" onclick="loadSelectedScheduleFromFTP()" id="loadScheduleFromFTPBtn" disabled>
                            <i class="fas fa-file-import"></i> Load Schedule
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Meetings Schedule Panel -->
        <div id="meetings" class="panel meeting-schedule-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-calendar-check"></i> Atlanta City Council Meetings Schedule</h2>
                <p>Manage and track Atlanta City Council meetings</p>
            </div>
            
            <div class="meeting-schedule-import-card">
                <div class="meeting-schedule-card-header">
                    <h3><i class="fas fa-sync"></i> Import Meetings</h3>
                </div>
                <div class="meeting-schedule-import-controls">
                    <button class="button primary" onclick="importMeetingsFromWeb()">
                        <i class="fas fa-download"></i> Import from City Council Website
                    </button>
                    <span class="meeting-schedule-import-status" id="importStatus"></span>
                </div>
            </div>
            
            <div class="meeting-schedule-table-card">
                <div class="meeting-schedule-card-header">
                    <h3><i class="fas fa-calendar"></i> Meetings Schedule</h3>
                    <button class="button primary small" onclick="openAddMeetingModal()">
                        <i class="fas fa-plus"></i> Add Meeting
                    </button>
                </div>
                <div class="meeting-schedule-table-container">
                    <table class="meeting-schedule-table" id="meetingsTable">
                        <thead>
                            <tr>
                                <th>Meeting Name</th>
                                <th>Date</th>
                                <th>Start Time</th>
                                <th>Duration</th>
                                <th>Room</th>
                                <th>ATL26</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="meetingsTableBody">
                            <!-- Meetings will be populated here -->
                        </tbody>
                    </table>
                    <div class="no-meetings" id="noMeetingsMessage" style="display: none;">
                        <p>No meetings scheduled. Click "Add Meeting" or import from the City Council website.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Fill Graphics Panel -->
        <div id="fill-graphics" class="panel fill-graphics-panel">
            <div class="dashboard-panel-header">
                <h2><i class="fas fa-image"></i> Fill Graphics Generator</h2>
                <p>Create slideshow project files (.prj) with graphics and music for Castus servers</p>
            </div>
            
            <div class="fill-graphics-card fill-graphics-region1-card">
                <div class="fill-graphics-card-header">
                    <h3><i class="fas fa-layer-group"></i> Region 1 - Upper Graphics</h3>
                </div>
                <div class="fill-graphics-card-content">
                    <p class="fill-graphics-info-text">Select graphics (*.jpg, *.png) for slideshow</p>
                    <div class="form-group">
                        <label for="region1Path">Folder Path</label>
                        <input type="text" id="region1Path" class="form-control" value="/mnt/main/ATL26 On-Air Content/DEFAULT ROTATION" onchange="loadRegion1Graphics()">
                    </div>
                    <div class="form-group">
                        <label for="region1Server">Server</label>
                        <select id="region1Server" class="form-control" onchange="loadRegion1Graphics()">
                            <option value="">Select server...</option>
                            <option value="source">Source Server</option>
                            <option value="target">Target Server</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <button class="button secondary small" onclick="selectAllRegion1Graphics()" id="selectAllRegion1Btn" style="display: none;">
                            <i class="fas fa-check-square"></i> Select All
                        </button>
                        <button class="button secondary small" onclick="deselectAllRegion1Graphics()" id="deselectAllRegion1Btn" style="display: none; margin-left: 0.5rem;">
                            <i class="fas fa-square"></i> Deselect All
                        </button>
                    </div>
                    <div class="graphics-list" id="region1GraphicsList">
                        <!-- Graphics will be loaded here -->
                    </div>
                </div>
            </div>

            <div class="fill-graphics-card fill-graphics-region2-card">
                <div class="fill-graphics-card-header">
                    <h3><i class="fas fa-layer-group"></i> Region 2 - Lower Graphics</h3>
                </div>
                <div class="fill-graphics-card-content">
                    <p class="fill-graphics-info-text">Select one static graphic (*.png or *.jpg)</p>
                    <div class="form-group">
                        <label for="region2Path">Folder Path</label>
                        <input type="text" id="region2Path" class="form-control" value="/mnt/main/Graphics" onchange="loadRegion2Graphics()">
                    </div>
                    <div class="form-group">
                        <label for="region2Server">Server</label>
                        <select id="region2Server" class="form-control" onchange="loadRegion2Graphics()">
                            <option value="">Select server...</option>
                            <option value="source">Source Server</option>
                            <option value="target">Target Server</option>
                        </select>
                    </div>
                    <div class="graphics-list" id="region2GraphicsList">
                        <!-- Graphics will be loaded here -->
                    </div>
                </div>
            </div>

            <div class="fill-graphics-card fill-graphics-region3-card">
                <div class="fill-graphics-card-header">
                    <h3><i class="fas fa-music"></i> Region 3 - Music</h3>
                </div>
                <div class="fill-graphics-card-content">
                    <p class="fill-graphics-info-text">Select music files (*.mp4 or *.wav)</p>
                    <div class="form-group">
                        <label for="region3Path">Folder Path</label>
                        <input type="text" id="region3Path" class="form-control" value="/mnt/main/Music" onchange="loadMusicFiles()">
                    </div>
                    <div class="form-group">
                        <label for="region3Server">Server</label>
                        <select id="region3Server" class="form-control" onchange="loadMusicFiles()">
                            <option value="">Select server...</option>
                            <option value="source">Source Server</option>
                            <option value="target">Target Server</option>
                        </select>
                    </div>
                    <div class="music-list" id="musicFilesList">
                        <!-- Music files will be loaded here -->
                    </div>
                </div>
            </div>

            <div class="fill-graphics-card">
                <div class="fill-graphics-card-header">
                    <h3><i class="fas fa-file-export"></i> Generate Project</h3>
                </div>
                <div class="fill-graphics-card-content">
                    <button class="button primary large" onclick="showGenerateProjectModal()" id="generateProjectBtn" disabled>
                        <i class="fas fa-magic"></i> Generate .PRJ File
                    </button>
                    <p class="help-text">Select files from all three regions to enable project generation</p>
                </div>
            </div>
        </div>

        <!-- Scanned Files Display -->
        <div class="card" id="scannedFilesCard" style="display: none;">
            <div class="card-header">
                <h3><i class="fas fa-list"></i> Scanned Files</h3>
                <div class="scanned-files-summary" id="scannedFilesSummary" style="display: none;">
                    <span id="scannedFilesSummaryText">No files scanned yet</span>
                </div>
                <button class="button secondary small" id="toggleScannedFilesBtn" onclick="toggleScannedFiles()">
                    <i class="fas fa-eye"></i> Show Details
                </button>
                <button class="button secondary small" id="toggleUnanalyzedOnlyBtn" onclick="toggleUnanalyzedOnly()" style="display: none; margin-left: 0.5rem;">
                    <i class="fas fa-filter"></i> Show Unanalyzed Only
                </button>
            </div>
            <div class="scanned-files-container" id="scannedFilesDetails" style="display: none;">
                <div class="scanned-files-section">
                    <h4><i class="fas fa-upload"></i> Source Server Files</h4>
                    <div class="file-count" id="sourceFileCount">No files scanned</div>
                    <div id="sourceFilesList" class="file-list"></div>
                </div>
                <div class="scanned-files-section">
                    <h4><i class="fas fa-download"></i> Target Server Files</h4>
                    <div class="file-count" id="targetFileCount">No files scanned</div>
                    <div id="targetFilesList" class="file-list"></div>
                </div>
            </div>
        </div>


        <!-- Meeting Trimmer Panel -->
        <div class="card" id="meetingTrimmerCard">
            <div class="card-header">
                <h3><i class="fas fa-cut"></i> Meeting Trimmer</h3>
                <div class="trimmer-buttons">
                    <button class="button primary small" onclick="showTrimSettings()">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <button class="button secondary small" onclick="refreshRecordingsList()">
                        <i class="fas fa-sync"></i> Refresh List
                    </button>
                    <button class="button secondary small" onclick="toggleRecordingsList()">
                        <i class="fas fa-eye-slash"></i> Hide List
                    </button>
                    <button class="button info small" id="autoTrimToggle" onclick="toggleAutoTrim()">
                        <i class="fas fa-robot"></i> Auto-Trim: OFF
                    </button>
                </div>
            </div>
            <div class="trimmer-content">
                <div id="recordingsList" class="recordings-list">
                    <p style="text-align: center; color: #666;">Click "Refresh List" to load recordings</p>
                </div>
            </div>
        </div>

        <!-- File Comparison Results -->
        <div class="card" id="comparisonCard" style="display: none;">
            <div class="card-header">
                <h3><i class="fas fa-balance-scale"></i> File Comparison Results</h3>
                <div class="comparison-summary" id="comparisonSummary">
                    <span id="comparisonSummaryText">No comparison results yet</span>
                </div>
                <div class="comparison-buttons">
                    <button class="button secondary small" id="toggleComparisonBtn" onclick="toggleComparisonView()">
                        <i class="fas fa-eye"></i> Show All Files
                    </button>
                    <button class="button secondary small" id="toggleTargetOnlyBtn" onclick="toggleTargetOnlyView()">
                        <i class="fas fa-eye"></i> Show Target-Only Files
                    </button>
                </div>
            </div>
            <div id="fileList" class="file-list"></div>
        </div>

        <!-- File Analysis Results -->
        <div class="card" id="analysisCard" style="display: none;">
            <div class="card-header">
                <h3><i class="fas fa-brain"></i> File Analysis Results</h3>
                <div class="analysis-summary" id="analysisSummary">
                    <span id="analysisSummaryText">No analysis results yet</span>
                </div>
                <div class="analysis-buttons">
                    <button class="button secondary small" id="toggleAnalysisBtn" onclick="toggleAnalysisView()">
                        <i class="fas fa-eye"></i> Show All Files
                    </button>
                    <button class="button secondary small" id="startAnalysisBtn" onclick="startAnalysis()" disabled>
                        <i class="fas fa-play"></i> Start Analysis
                    </button>
                </div>
            </div>
            <div id="analysisFileList" class="file-list"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-terminal"></i> Status & Logs</h3>
                <button class="button secondary small" id="toggleStatusBtn" onclick="toggleStatus()">
                    <i class="fas fa-eye"></i> Show Logs
                </button>
            </div>
            <div id="status" class="status" style="display: none;">
                <div class="log-entry info">Ready to sync. Configure your servers and click "Scan Files" to begin.</div>
            </div>
        </div>
    </div>

    <!-- Rename Content Modal -->
    <div id="renameContentModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Rename Content File</h3>
                <button class="modal-close" onclick="closeRenameDialog()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="renameContentInfo" style="margin-bottom: 20px;">
                    <!-- Current file info will be populated here -->
                </div>
                
                <div class="form-group">
                    <label>Current File Name</label>
                    <input type="text" id="currentFileName" class="form-control" readonly>
                </div>
                
                <div class="form-group">
                    <label>New File Name</label>
                    <input type="text" id="newFileName" class="form-control">
                    <small class="form-help">Format: YYMMDD_TYPE_Description.mp4</small>
                </div>
                
                <div class="form-group">
                    <label>Encoded Date (from database)</label>
                    <input type="text" id="encodedDateDisplay" class="form-control" readonly>
                </div>
                
                
                <div class="rename-actions">
                    <button class="button primary" onclick="generateSuggestedName()">
                        <i class="fas fa-magic"></i> Suggest Name
                    </button>
                    <button class="button secondary" onclick="previewRename()">
                        <i class="fas fa-eye"></i> Preview
                    </button>
                </div>
                
                <div id="renamePreview" style="margin-top: 20px; display: none;">
                    <!-- Preview will be shown here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="button danger" onclick="executeRename()">
                    <i class="fas fa-save"></i> Apply Changes
                </button>
                <button class="button secondary" onclick="closeRenameDialog()">Cancel</button>
            </div>
        </div>
    </div>



    <!-- Template Library Modal -->
    <div id="templateLibraryModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-folder-open"></i> Template Library</h3>
            </div>
            <div class="modal-body">
                <div id="templateLibraryList" style="max-height: 500px; overflow-y: auto;">
                    <p style="text-align: center; color: #666;">Loading templates...</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeTemplateLibraryModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Template Export Modal -->
    <div id="templateExportModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-export"></i> Export Template</h3>
                <button class="modal-close" onclick="closeTemplateExportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Template Name</label>
                    <p id="exportTemplateName" style="font-weight: bold; margin: 5px 0;"></p>
                </div>
                <div class="form-group">
                    <label for="templateExportServer">Export Server</label>
                    <select id="templateExportServer" class="form-control">
                        <option value="source">Source Server</option>
                        <option value="target" selected>Target Server</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="templateExportPath">Export Path</label>
                    <input type="text" id="templateExportPath" class="form-control" value="/mnt/main/Schedules" placeholder="/path/to/export">
                </div>
                <div class="form-group">
                    <label for="templateExportFilename">Filename</label>
                    <input type="text" id="templateExportFilename" class="form-control" placeholder="template_name.sch">
                </div>
                <div class="form-group">
                    <label for="templateExportFormat">Export Format</label>
                    <select id="templateExportFormat" class="form-control">
                        <option value="castus_daily">Castus Daily Schedule</option>
                        <option value="castus_weekly">Castus Weekly Schedule</option>
                        <option value="castus_monthly">Castus Monthly Schedule</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeTemplateExportModal()">Cancel</button>
                <button class="button primary" onclick="confirmTemplateExport()">
                    <i class="fas fa-file-export"></i> Export
                </button>
            </div>
        </div>
    </div>

    <!-- Load Template Modal -->
    <div id="loadTemplateModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-download"></i> <span id="loadTemplateModalTitle">Load Daily Schedule Template</span></h3>
                <button class="modal-close" onclick="closeLoadTemplateModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="templateServer">Select Server</label>
                    <select id="templateServer" class="form-control" onchange="loadTemplateFiles()">
                        <option value="">Select a server...</option>
                        <option value="source">Source Server</option>
                        <option value="target">Target Server</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="templatePath">Template Path</label>
                    <input type="text" id="templatePath" class="form-control" value="/mnt/main/Schedules" placeholder="/path/to/schedules">
                    <button class="button secondary small" onclick="loadTemplateFiles()" style="margin-top: 5px;">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <div class="form-group">
                    <label>Available Schedule Files</label>
                    <div id="templateFileList" class="file-list" style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px;">
                        <p style="color: #666;">Select a server and click Refresh to load schedule files</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeLoadTemplateModal()">Cancel</button>
                <button class="button primary" onclick="loadSelectedTemplate()" id="loadTemplateBtn" disabled>
                    <i class="fas fa-file-download"></i> Load Template
                </button>
            </div>
        </div>
    </div>

    <!-- Trim Analysis Modal -->
    <div id="trimAnalysisModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-cut"></i> Trim Analysis & Processing</h3>
                <button class="modal-close" onclick="closeTrimAnalysisModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- File Information -->
                <div class="trim-section">
                    <h4>File Information</h4>
                    <div class="form-group">
                        <label>File</label>
                        <p id="trimAnalysisFilename" style="font-weight: bold; word-break: break-all;"></p>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <button class="button primary" onclick="downloadForTrim()" id="downloadForTrimBtn">
                                <i class="fas fa-download"></i> Download File
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="button secondary" onclick="viewOriginalFile()" id="viewOriginalBtn" disabled>
                                <i class="fas fa-play"></i> View Original
                            </button>
                        </div>
                    </div>
                </div>
                
                <hr>
                
                <!-- Trim Point Analysis -->
                <div class="trim-section">
                    <h4>Trim Point Analysis</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <button class="button primary" onclick="findTrimPoints(false)" id="findTrimPointsBtn">
                                <i class="fas fa-search"></i> Find Trim Points
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="button secondary" onclick="findTrimPoints(true)" id="findTrimPointsAIBtn">
                                <i class="fas fa-bolt"></i> Fast AI Detection
                            </button>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Start Trim</label>
                            <div class="timecode-group">
                                <input type="text" id="trimStartTimecode" class="form-control timecode" placeholder="00:00:00.0" readonly>
                                <input type="number" id="trimAnalysisStartTime" class="form-control" min="0" step="0.1" placeholder="0.0">
                                <small>seconds</small>
                            </div>
                            <div class="detected-words">
                                <small><i class="fas fa-quote-left"></i> <span id="startWords">No words detected yet</span></small>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>End Trim</label>
                            <div class="timecode-group">
                                <input type="text" id="trimEndTimecode" class="form-control timecode" placeholder="00:00:00.0" readonly>
                                <input type="number" id="trimAnalysisEndTime" class="form-control" min="0" step="0.1" placeholder="0.0">
                                <small>seconds</small>
                            </div>
                            <div class="detected-words">
                                <small><i class="fas fa-quote-right"></i> <span id="endWords">No words detected yet</span></small>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <button class="button secondary small" onclick="previewTrimStart()" id="previewStartBtn" disabled>
                                <i class="fas fa-step-forward"></i> Preview Start
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="button secondary small" onclick="previewTrimEnd()" id="previewEndBtn" disabled>
                                <i class="fas fa-step-backward"></i> Preview End
                            </button>
                        </div>
                    </div>
                </div>
                
                <hr>
                
                <!-- Trimming -->
                <div class="trim-section">
                    <h4>Trimming</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Trimmed Duration</label>
                            <p id="trimAnalysisNewDuration" class="duration-display">--:--:--</p>
                        </div>
                        <div class="form-group">
                            <button class="button primary" onclick="executeTrim()" id="executeTrimBtn" disabled>
                                <i class="fas fa-cut"></i> Trim File
                            </button>
                        </div>
                    </div>
                </div>
                
                <hr>
                
                <!-- Final Steps -->
                <div class="trim-section">
                    <h4>Final Steps</h4>
                    <div class="form-group">
                        <label for="trimAnalysisNewFilename">Final Filename</label>
                        <input type="text" id="trimAnalysisNewFilename" class="form-control">
                        <small>Edit filename before copying to destination</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group" id="viewTrimmedGroup" style="display: none;">
                            <button class="button secondary" onclick="viewTrimmedFile()" id="viewTrimmedBtn">
                                <i class="fas fa-play"></i> View Trimmed File
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="button success" onclick="copyToDestination('castus1')" id="copyCastus1Btn" disabled>
                                <i class="fas fa-copy"></i> Copy to Castus1
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="button success" onclick="copyToDestination('castus2')" id="copyCastus2Btn" disabled>
                                <i class="fas fa-copy"></i> Copy to Castus2
                            </button>
                        </div>
                        <div class="form-group">
                            <button class="button danger small" onclick="deleteTrimmedFile()" id="deleteTrimmedBtn" disabled>
                                <i class="fas fa-trash"></i> Delete Trimmed
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Status Display -->
                <div id="trimAnalysisStatus" style="margin-top: 1rem; display: none;">
                    <div class="alert alert-info">
                        <i class="fas fa-spinner fa-spin"></i> <span id="trimAnalysisStatusText">Processing...</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeTrimAnalysisModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Video Trim Preview Modal -->
    <div id="videoTrimModal" class="modal">
        <div class="modal-content" style="max-width: 90%; width: 900px;">
            <div class="modal-header">
                <h3><i class="fas fa-video"></i> Trim Point Selection</h3>
                <button class="modal-close" onclick="closeVideoTrimModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="video-container" style="position: relative;">
                    <video id="trimVideo" controls style="width: 100%; max-height: 500px;"></video>
                    <div class="video-controls" style="margin-top: 1rem;">
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <label>Current Time</label>
                                <div class="current-time-display">
                                    <span id="currentTimeDisplay" style="font-family: monospace; font-size: 1.2rem;">00:00:00.0</span>
                                    <span id="currentSecondsDisplay" style="color: #666; margin-left: 1rem;">0.0s</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <button class="button primary" onclick="setTrimPoint()" id="setTrimPointBtn">
                                    <i class="fas fa-cut"></i> Set as Start Point
                                </button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <label>Skip Controls</label>
                                <div class="skip-buttons">
                                    <button class="button small" onclick="skipVideo(-30)">-30s</button>
                                    <button class="button small" onclick="skipVideo(-10)">-10s</button>
                                    <button class="button small" onclick="skipVideo(-5)">-5s</button>
                                    <button class="button small" onclick="skipVideo(5)">+5s</button>
                                    <button class="button small" onclick="skipVideo(10)">+10s</button>
                                    <button class="button small" onclick="skipVideo(30)">+30s</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Trim Settings Modal -->
    <div id="trimSettingsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Meeting Trim Settings</h3>
                <button class="modal-close" onclick="closeTrimSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="trimServer">Server</label>
                    <select id="trimServer" class="form-control">
                        <option value="source">Source Server</option>
                        <option value="target" selected>Target Server</option>
                    </select>
                    <small>Select which server to scan for recordings</small>
                </div>
                <div class="form-group">
                    <label for="trimSourcePath">Recordings Path</label>
                    <input type="text" id="trimSourcePath" class="form-control" value="/mnt/main/Recordings">
                    <small>Path to scan for meeting recordings (searches subdirectories)</small>
                </div>
                <div class="form-group">
                    <label for="trimDestPath">Destination Path</label>
                    <input type="text" id="trimDestPath" class="form-control" value="/mnt/main/ATL26 On-Air Content/MEETINGS">
                    <small>Where to copy trimmed files</small>
                </div>
                <div class="form-group">
                    <label for="keepOriginal">
                        <input type="checkbox" id="keepOriginal" checked>
                        Keep original file after trimming
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeTrimSettingsModal()">Cancel</button>
                <button class="button primary" onclick="saveTrimSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Meeting Modal -->
    <div id="meetingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="meetingModalTitle">Add Meeting</h2>
                <button class="close-button" onclick="closeMeetingModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="meetingForm">
                    <input type="hidden" id="meetingId" value="">
                    <div class="form-group">
                        <label for="meetingName">Meeting Name</label>
                        <input type="text" id="meetingName" required placeholder="e.g., City Council Regular Meeting">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="meetingDate">Date</label>
                            <input type="date" id="meetingDate" required>
                        </div>
                        <div class="form-group">
                            <label for="meetingTime">Start Time</label>
                            <input type="time" id="meetingTime" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="meetingDuration">Duration (hours)</label>
                            <input type="number" id="meetingDuration" min="0.5" max="6" step="0.5" value="2" required>
                        </div>
                        <div class="form-group">
                            <label for="meetingRoom">Room</label>
                            <input type="text" id="meetingRoom" placeholder="e.g., Council Chamber">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="meetingBroadcast" checked>
                            Broadcast on ATL26
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeMeetingModal()">Cancel</button>
                <button class="button primary" onclick="saveMeeting()">Save Meeting</button>
            </div>
        </div>
    </div>

    <!-- Import Daily Meetings Modal -->
    <div id="importDailyMeetingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Import Daily Meetings</h2>
                <button class="close-button" onclick="closeImportDailyMeetingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="dailyMeetingDate">Select Date</label>
                    <input type="date" id="dailyMeetingDate" required>
                </div>
                <div class="meetings-selection">
                    <h3>Available Meetings</h3>
                    <div id="dailyMeetingsList" class="meetings-checklist">
                        <!-- Meetings will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeImportDailyMeetingsModal()">Cancel</button>
                <button class="button primary" onclick="generateDailySchedule()">Import Selected</button>
            </div>
        </div>
    </div>

    <!-- Import Weekly Meetings Modal -->
    <div id="importWeeklyMeetingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Import Weekly Meetings</h2>
                <button class="close-button" onclick="closeImportWeeklyMeetingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="weeklyMeetingYear">Year</label>
                        <input type="number" id="weeklyMeetingYear" min="2025" max="2030" value="2025" required>
                    </div>
                    <div class="form-group">
                        <label for="weeklyMeetingWeek">Week Number</label>
                        <input type="number" id="weeklyMeetingWeek" min="1" max="53" required>
                    </div>
                </div>
                <div class="form-group">
                    <small id="weekDateRange" class="text-muted"></small>
                </div>
                <div class="meetings-selection">
                    <h3>Available Meetings</h3>
                    <div id="weeklyMeetingsList" class="meetings-checklist">
                        <!-- Meetings will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeImportWeeklyMeetingsModal()">Cancel</button>
                <button class="button primary" onclick="generateWeeklySchedule()">Import Selected</button>
            </div>
        </div>
    </div>

    <!-- Import Monthly Meetings Modal -->
    <div id="importMonthlyMeetingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Import Monthly Meetings</h2>
                <button class="close-button" onclick="closeImportMonthlyMeetingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="monthlyMeetingYear">Year</label>
                        <input type="number" id="monthlyMeetingYear" min="2025" max="2030" value="2025" required>
                    </div>
                    <div class="form-group">
                        <label for="monthlyMeetingMonth">Month</label>
                        <select id="monthlyMeetingMonth" required>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                </div>
                <div class="meetings-selection">
                    <h3>Available Meetings</h3>
                    <div id="monthlyMeetingsList" class="meetings-checklist">
                        <!-- Meetings will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeImportMonthlyMeetingsModal()">Cancel</button>
                <button class="button primary" onclick="generateMonthlySchedule()">Import Selected</button>
            </div>
        </div>
    </div>

    <!-- Generate Project Modal -->
    <div id="generateProjectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Generate Project File</h2>
                <button class="close-button" onclick="closeGenerateProjectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="projectFileName">Project File Name</label>
                    <input type="text" id="projectFileName" class="form-control" placeholder="Enter project name (without .prj extension)" required>
                </div>
                <div class="form-group">
                    <label for="projectExportPath">Export Path</label>
                    <input type="text" id="projectExportPath" class="form-control" value="/mnt/main/Projects/" required>
                </div>
                <div class="form-group">
                    <label for="projectExportServer">Export to Server</label>
                    <select id="projectExportServer" class="form-control">
                        <option value="source">Source Server</option>
                        <option value="target">Target Server</option>
                    </select>
                </div>
                <div class="project-summary">
                    <h4>Selected Files Summary:</h4>
                    <div id="projectSummary">
                        <!-- Summary will be populated here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" onclick="closeGenerateProjectModal()">Cancel</button>
                <button class="button primary" onclick="generateProjectFile()">
                    <i class="fas fa-file-export"></i> Generate & Export
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>
    
    <!-- Core Scripts -->
    <script src="main.js"></script>
    <script src="api/base.api.js"></script>
    <script src="api/scheduling.api.js"></script>
    
    <!-- Module-specific JavaScript -->
    <script src="dashboard/dashboard.js"></script>
    <script src="servers/servers.js"></script>
    <script src="settings/settings.js"></script>
    <script src="ai_settings/ai_settings.js"></script>
    <script src="admin/admin.js"></script>
    <script src="scheduling/scheduling.js"></script>
    <script src="scheduling/scheduling_templates.js"></script>
    <script src="meeting_schedule/meeting_schedule.js"></script>
    <script src="fill_graphics/fill_graphics.js"></script>
    
    <!-- Legacy script for compatibility -->
    <script src="script.js"></script>
</body>
</html>